/* Accessibility Features - ARIA Labels, Keyboard Navigation, and More */

/* === SCREEN READER UTILITIES === */

/* Screen reader only text */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

/* Screen reader only text that becomes visible on focus */
.sr-only-focusable:focus {
  position: static;
  width: auto;
  height: auto;
  padding: inherit;
  margin: inherit;
  overflow: visible;
  clip: auto;
  white-space: normal;
}

/* Skip links for keyboard navigation */
.skip-link {
  position: absolute;
  top: -40px;
  left: 6px;
  background: var(--duolingo-green);
  color: white;
  padding: 8px 16px;
  text-decoration: none;
  border-radius: 4px;
  font-weight: 600;
  z-index: 1000;
  transition: top var(--duration-200) var(--ease-in-out);
}

.skip-link:focus {
  top: 6px;
}

/* === FOCUS MANAGEMENT === */

/* Focus outline styles */
.focus-visible {
  outline: 2px solid var(--duolingo-green);
  outline-offset: 2px;
}

.focus-visible-inset {
  outline: 2px solid var(--duolingo-green);
  outline-offset: -2px;
}

/* Remove focus outline for mouse users */
.focus-visible:not(:focus-visible) {
  outline: none;
}

/* High contrast focus styles */
@media (prefers-contrast: high) {
  .focus-visible {
    outline: 3px solid var(--duolingo-green);
    outline-offset: 3px;
  }
  
  .focus-visible-inset {
    outline: 3px solid var(--duolingo-green);
    outline-offset: -3px;
  }
}

/* Focus trap for modals */
.focus-trap {
  position: relative;
}

.focus-trap::before,
.focus-trap::after {
  content: '';
  position: absolute;
  width: 1px;
  height: 1px;
  opacity: 0;
  pointer-events: none;
}

.focus-trap::before {
  top: 0;
  left: 0;
}

.focus-trap::after {
  bottom: 0;
  right: 0;
}

/* === KEYBOARD NAVIGATION === */

/* Keyboard navigation indicators */
.keyboard-nav {
  position: relative;
}

.keyboard-nav::before {
  content: '';
  position: absolute;
  top: -2px;
  left: -2px;
  right: -2px;
  bottom: -2px;
  border: 2px solid transparent;
  border-radius: inherit;
  transition: border-color var(--duration-200) var(--ease-in-out);
  pointer-events: none;
}

.keyboard-nav:focus-visible::before {
  border-color: var(--duolingo-green);
}

/* Tab order management */
.tab-order-1 { order: 1; }
.tab-order-2 { order: 2; }
.tab-order-3 { order: 3; }
.tab-order-4 { order: 4; }
.tab-order-5 { order: 5; }
.tab-order-6 { order: 6; }
.tab-order-7 { order: 7; }
.tab-order-8 { order: 8; }
.tab-order-9 { order: 9; }
.tab-order-10 { order: 10; }

/* Tab index utilities */
.tab-index-0 { tab-index: 0; }
.tab-index-1 { tab-index: 1; }
.tab-index-2 { tab-index: 2; }
.tab-index-3 { tab-index: 3; }
.tab-index-4 { tab-index: 4; }
.tab-index-5 { tab-index: 5; }
.tab-index-6 { tab-index: 6; }
.tab-index-7 { tab-index: 7; }
.tab-index-8 { tab-index: 8; }
.tab-index-9 { tab-index: 9; }
.tab-index-10 { tab-index: 10; }

.tab-index-negative { tab-index: -1; }

/* === ARIA UTILITIES === */

/* ARIA hidden */
.aria-hidden {
  aria-hidden: true;
}

.aria-hidden-false {
  aria-hidden: false;
}

/* ARIA expanded */
.aria-expanded-true {
  aria-expanded: true;
}

.aria-expanded-false {
  aria-expanded: false;
}

/* ARIA selected */
.aria-selected-true {
  aria-selected: true;
}

.aria-selected-false {
  aria-selected: false;
}

/* ARIA checked */
.aria-checked-true {
  aria-checked: true;
}

.aria-checked-false {
  aria-checked: false;
}

.aria-checked-mixed {
  aria-checked: mixed;
}

/* ARIA disabled */
.aria-disabled-true {
  aria-disabled: true;
}

.aria-disabled-false {
  aria-disabled: false;
}

/* ARIA required */
.aria-required-true {
  aria-required: true;
}

.aria-required-false {
  aria-required: false;
}

/* ARIA invalid */
.aria-invalid-true {
  aria-invalid: true;
}

.aria-invalid-false {
  aria-invalid: false;
}

/* ARIA live regions */
.aria-live-off {
  aria-live: off;
}

.aria-live-polite {
  aria-live: polite;
}

.aria-live-assertive {
  aria-live: assertive;
}

/* ARIA atomic */
.aria-atomic-true {
  aria-atomic: true;
}

.aria-atomic-false {
  aria-atomic: false;
}

/* ARIA relevant */
.aria-relevant-additions {
  aria-relevant: additions;
}

.aria-relevant-removals {
  aria-relevant: removals;
}

.aria-relevant-text {
  aria-relevant: text;
}

.aria-relevant-all {
  aria-relevant: all;
}

/* ARIA busy */
.aria-busy-true {
  aria-busy: true;
}

.aria-busy-false {
  aria-busy: false;
}

/* === SEMANTIC HTML UTILITIES === */

/* Heading hierarchy */
.heading-1 { font-size: var(--font-size-4xl); font-weight: var(--font-weight-extrabold); }
.heading-2 { font-size: var(--font-size-3xl); font-weight: var(--font-weight-bold); }
.heading-3 { font-size: var(--font-size-2xl); font-weight: var(--font-weight-semibold); }
.heading-4 { font-size: var(--font-size-xl); font-weight: var(--font-weight-semibold); }
.heading-5 { font-size: var(--font-size-lg); font-weight: var(--font-weight-medium); }
.heading-6 { font-size: var(--font-size-base); font-weight: var(--font-weight-medium); }

/* Landmark roles */
.landmark-main { role: main; }
.landmark-navigation { role: navigation; }
.landmark-banner { role: banner; }
.landmark-contentinfo { role: contentinfo; }
.landmark-complementary { role: complementary; }
.landmark-search { role: search; }
.landmark-form { role: form; }

/* === COLOR AND CONTRAST === */

/* High contrast mode support */
@media (prefers-contrast: high) {
  :root {
    --color-primary: #000000;
    --color-secondary: #000000;
    --color-text-primary: #000000;
    --color-text-secondary: #000000;
    --color-border-primary: #000000;
    --color-border-secondary: #000000;
  }
  
  [data-theme="dark"] {
    --color-primary: #ffffff;
    --color-secondary: #ffffff;
    --color-text-primary: #ffffff;
    --color-text-secondary: #ffffff;
    --color-border-primary: #ffffff;
    --color-border-secondary: #ffffff;
  }
}

/* Color contrast utilities */
.contrast-high {
  color: var(--color-gray-900);
  background: var(--color-white);
}

.contrast-low {
  color: var(--color-gray-500);
  background: var(--color-gray-100);
}

/* === MOTION AND ANIMATION === */

/* Respect user's motion preferences */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

/* Reduced motion alternatives */
.reduced-motion-alternative {
  transition: none;
  animation: none;
}

.reduced-motion-alternative:hover {
  transform: none;
}

/* === TOUCH AND POINTER === */

/* Touch target sizes */
.touch-target {
  min-height: 44px;
  min-width: 44px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.touch-target-large {
  min-height: 48px;
  min-width: 48px;
}

.touch-target-extra-large {
  min-height: 56px;
  min-width: 56px;
}

/* Pointer type detection */
@media (pointer: coarse) {
  .pointer-coarse {
    /* Styles for touch devices */
  }
}

@media (pointer: fine) {
  .pointer-fine {
    /* Styles for mouse devices */
  }
}

@media (pointer: none) {
  .pointer-none {
    /* Styles for devices without pointing devices */
  }
}

/* === FORM ACCESSIBILITY === */

/* Form field groups */
.field-group {
  margin-bottom: 16px;
}

.field-label {
  display: block;
  font-weight: var(--font-weight-medium);
  color: var(--theme-text-primary);
  margin-bottom: 4px;
}

.field-label-required::after {
  content: ' *';
  color: var(--color-error);
}

.field-description {
  font-size: var(--font-size-sm);
  color: var(--theme-text-secondary);
  margin-top: 4px;
}

.field-error {
  font-size: var(--font-size-sm);
  color: var(--color-error);
  margin-top: 4px;
}

.field-success {
  font-size: var(--font-size-sm);
  color: var(--color-success);
  margin-top: 4px;
}

/* Form validation states */
.field-invalid {
  border-color: var(--color-error);
}

.field-invalid:focus {
  border-color: var(--color-error);
  box-shadow: 0 0 0 3px rgba(220, 38, 38, 0.1);
}

.field-valid {
  border-color: var(--color-success);
}

.field-valid:focus {
  border-color: var(--color-success);
  box-shadow: 0 0 0 3px rgba(34, 197, 94, 0.1);
}

/* === NAVIGATION ACCESSIBILITY === */

/* Navigation landmarks */
.nav-primary {
  role: navigation;
  aria-label: 'Primary navigation';
}

.nav-secondary {
  role: navigation;
  aria-label: 'Secondary navigation';
}

.nav-breadcrumb {
  role: navigation;
  aria-label: 'Breadcrumb';
}

.nav-pagination {
  role: navigation;
  aria-label: 'Pagination';
}

/* Navigation lists */
.nav-list {
  list-style: none;
  padding: 0;
  margin: 0;
}

.nav-item {
  display: block;
}

.nav-link {
  display: block;
  padding: 8px 16px;
  color: var(--theme-text-primary);
  text-decoration: none;
  transition: background-color var(--duration-200) var(--ease-in-out);
}

.nav-link:hover {
  background: var(--theme-button-hover);
}

.nav-link:focus {
  outline: 2px solid var(--duolingo-green);
  outline-offset: -2px;
}

.nav-link.active {
  background: var(--duolingo-green);
  color: white;
}

/* === TABLE ACCESSIBILITY === */

/* Accessible tables */
.table-accessible {
  border-collapse: collapse;
  width: 100%;
  margin-bottom: 16px;
}

.table-accessible th,
.table-accessible td {
  padding: 12px;
  text-align: left;
  border-bottom: 1px solid var(--theme-border-primary);
}

.table-accessible th {
  background: var(--theme-bg-secondary);
  font-weight: var(--font-weight-semibold);
  color: var(--theme-text-primary);
}

.table-accessible tbody tr:hover {
  background: var(--theme-bg-secondary);
}

.table-accessible tbody tr:focus {
  outline: 2px solid var(--duolingo-green);
  outline-offset: -2px;
}

/* Table caption */
.table-caption {
  caption-side: top;
  text-align: left;
  font-weight: var(--font-weight-semibold);
  color: var(--theme-text-primary);
  margin-bottom: 8px;
}

/* === LIST ACCESSIBILITY === */

/* Accessible lists */
.list-accessible {
  list-style: none;
  padding: 0;
  margin: 0;
}

.list-item-accessible {
  padding: 8px 0;
  border-bottom: 1px solid var(--theme-border-primary);
}

.list-item-accessible:last-child {
  border-bottom: none;
}

.list-item-accessible:focus {
  outline: 2px solid var(--duolingo-green);
  outline-offset: -2px;
  background: var(--theme-bg-secondary);
}

/* === MODAL ACCESSIBILITY === */

/* Accessible modals */
.modal-accessible {
  role: dialog;
  aria-modal: true;
  aria-labelledby: 'modal-title';
  aria-describedby: 'modal-description';
}

.modal-accessible .modal-title {
  id: 'modal-title';
}

.modal-accessible .modal-body {
  id: 'modal-description';
}

/* Modal backdrop */
.modal-backdrop {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: var(--theme-modal-overlay);
  z-index: 999;
}

/* === ALERT ACCESSIBILITY === */

/* Accessible alerts */
.alert-accessible {
  role: alert;
  aria-live: assertive;
  padding: 12px 16px;
  border-radius: 8px;
  margin-bottom: 16px;
}

.alert-accessible.alert-success {
  background: var(--color-success-bg);
  border: 1px solid var(--color-success-border);
  color: var(--color-success-text);
}

.alert-accessible.alert-warning {
  background: var(--color-warning-bg);
  border: 1px solid var(--color-warning-border);
  color: var(--color-warning-text);
}

.alert-accessible.alert-error {
  background: var(--color-error-bg);
  border: 1px solid var(--color-error-border);
  color: var(--color-error-text);
}

.alert-accessible.alert-info {
  background: var(--color-info-bg);
  border: 1px solid var(--color-info-border);
  color: var(--color-info-text);
}

/* === PROGRESS ACCESSIBILITY === */

/* Accessible progress bars */
.progress-accessible {
  role: progressbar;
  aria-valuenow: 0;
  aria-valuemin: 0;
  aria-valuemax: 100;
  aria-label: 'Progress';
}

.progress-accessible[aria-valuenow] {
  /* Progress value will be set dynamically */
}

/* === BUTTON ACCESSIBILITY === */

/* Accessible buttons */
.button-accessible {
  role: button;
  tabindex: 0;
}

.button-accessible:focus {
  outline: 2px solid var(--duolingo-green);
  outline-offset: 2px;
}

.button-accessible:disabled {
  aria-disabled: true;
  cursor: not-allowed;
}

/* Toggle buttons */
.button-toggle {
  role: button;
  aria-pressed: false;
  tabindex: 0;
}

.button-toggle[aria-pressed="true"] {
  /* Active state styles */
}

/* === LINK ACCESSIBILITY === */

/* Accessible links */
.link-accessible {
  color: var(--duolingo-green);
  text-decoration: underline;
  text-decoration-thickness: 2px;
  text-underline-offset: 2px;
}

.link-accessible:hover {
  color: var(--duolingo-green-hover);
  text-decoration-thickness: 3px;
}

.link-accessible:focus {
  outline: 2px solid var(--duolingo-green);
  outline-offset: 2px;
}

.link-accessible:visited {
  color: var(--duolingo-green-dark);
}

/* External links */
.link-external::after {
  content: ' (opens in new tab)';
  font-size: var(--font-size-xs);
  color: var(--theme-text-muted);
}

.link-external[aria-label]::after {
  content: '';
}

/* === IMAGE ACCESSIBILITY === */

/* Decorative images */
.img-decorative {
  role: presentation;
  aria-hidden: true;
}

/* Images with alt text */
.img-accessible {
  alt: '';
  /* Alt text should be provided via the alt attribute */
}

/* === VIDEO ACCESSIBILITY === */

/* Accessible videos */
.video-accessible {
  role: video;
  aria-label: 'Video player';
}

.video-accessible video {
  width: 100%;
  height: auto;
}

.video-accessible .video-controls {
  display: flex;
  gap: 8px;
  padding: 8px;
  background: var(--theme-bg-secondary);
  border-radius: 8px;
  margin-top: 8px;
}

.video-accessible .video-controls button {
  padding: 8px 12px;
  background: var(--duolingo-green);
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-size: 14px;
}

.video-accessible .video-controls button:hover {
  background: var(--duolingo-green-hover);
}

.video-accessible .video-controls button:focus {
  outline: 2px solid var(--duolingo-green);
  outline-offset: 2px;
}

/* === AUDIO ACCESSIBILITY === */

/* Accessible audio */
.audio-accessible {
  role: audio;
  aria-label: 'Audio player';
}

.audio-accessible audio {
  width: 100%;
}

.audio-accessible .audio-controls {
  display: flex;
  gap: 8px;
  padding: 8px;
  background: var(--theme-bg-secondary);
  border-radius: 8px;
  margin-top: 8px;
}

.audio-accessible .audio-controls button {
  padding: 8px 12px;
  background: var(--duolingo-green);
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-size: 14px;
}

.audio-accessible .audio-controls button:hover {
  background: var(--duolingo-green-hover);
}

.audio-accessible .audio-controls button:focus {
  outline: 2px solid var(--duolingo-green);
  outline-offset: 2px;
}

/* === RESPONSIVE ACCESSIBILITY === */

@media (max-width: 768px) {
  .touch-target {
    min-height: 48px;
    min-width: 48px;
  }
  
  .touch-target-large {
    min-height: 52px;
    min-width: 52px;
  }
  
  .touch-target-extra-large {
    min-height: 60px;
    min-width: 60px;
  }
}

@media (max-width: 480px) {
  .touch-target {
    min-height: 52px;
    min-width: 52px;
  }
  
  .touch-target-large {
    min-height: 56px;
    min-width: 56px;
  }
  
  .touch-target-extra-large {
    min-height: 64px;
    min-width: 64px;
  }
}

/* === ACCESSIBILITY TESTING === */

/* Debug mode for accessibility testing */
.accessibility-debug {
  position: fixed;
  bottom: 20px;
  left: 20px;
  background: var(--theme-card-bg);
  border: 1px solid var(--theme-card-border);
  border-radius: 8px;
  padding: 12px;
  font-size: 12px;
  color: var(--theme-text-secondary);
  z-index: 1000;
  max-width: 200px;
  display: none;
}

.accessibility-debug.active {
  display: block;
}

.accessibility-debug-title {
  font-weight: 600;
  color: var(--theme-text-primary);
  margin-bottom: 8px;
}

.accessibility-debug-item {
  display: flex;
  justify-content: space-between;
  margin-bottom: 4px;
}

.accessibility-debug-label {
  color: var(--theme-text-secondary);
}

.accessibility-debug-value {
  color: var(--theme-text-primary);
  font-weight: 500;
}

/* === ACCESSIBILITY UTILITIES === */

/* Hide from screen readers but keep visible */
.visually-hidden {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

/* Show only to screen readers */
.screen-reader-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

/* Show only to screen readers but focusable */
.screen-reader-only-focusable:focus {
  position: static;
  width: auto;
  height: auto;
  padding: inherit;
  margin: inherit;
  overflow: visible;
  clip: auto;
  white-space: normal;
}

/* === ACCESSIBILITY ANIMATIONS === */

/* Respect user's motion preferences for accessibility */
@media (prefers-reduced-motion: reduce) {
  .accessibility-animation {
    animation: none;
    transition: none;
  }
}

/* Accessibility-friendly animations */
.accessibility-animation {
  transition: all var(--duration-200) var(--ease-in-out);
}

.accessibility-animation:hover {
  transform: translateY(-1px);
}

.accessibility-animation:focus {
  transform: none;
  outline: 2px solid var(--duolingo-green);
  outline-offset: 2px;
}

/* === ACCESSIBILITY FOCUS MANAGEMENT === */

/* Focus management for single-page applications */
.focus-manager {
  position: relative;
}

.focus-manager .focus-trap-start,
.focus-manager .focus-trap-end {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

.focus-manager .focus-trap-start:focus,
.focus-manager .focus-trap-end:focus {
  position: static;
  width: auto;
  height: auto;
  padding: inherit;
  margin: inherit;
  overflow: visible;
  clip: auto;
  white-space: normal;
}

/* === ACCESSIBILITY TESTING HELPERS === */

/* High contrast mode for testing */
.test-high-contrast {
  filter: contrast(200%);
}

/* Color blindness simulation */
.test-protanopia {
  filter: url(#protanopia);
}

.test-deuteranopia {
  filter: url(#deuteranopia);
}

.test-tritanopia {
  filter: url(#tritanopia);
}

/* === ACCESSIBILITY COMPLIANCE === */

/* WCAG 2.1 AA compliance helpers */
.wcag-aa {
  /* Ensure minimum contrast ratios */
  color: var(--theme-text-primary);
  background: var(--theme-bg-primary);
}

.wcag-aa-large-text {
  /* Large text has lower contrast requirements */
  font-size: var(--font-size-lg);
  color: var(--theme-text-primary);
  background: var(--theme-bg-primary);
}

.wcag-aa-focus {
  /* Focus indicators must be visible */
  outline: 2px solid var(--duolingo-green);
  outline-offset: 2px;
}

.wcag-aa-touch-target {
  /* Touch targets must be at least 44x44px */
  min-height: 44px;
  min-width: 44px;
}

/* === ACCESSIBILITY DOCUMENTATION === */

/* Accessibility documentation styles */
.accessibility-docs {
  background: var(--theme-bg-secondary);
  border: 1px solid var(--theme-border-primary);
  border-radius: 8px;
  padding: 16px;
  margin: 16px 0;
}

.accessibility-docs-title {
  font-size: 18px;
  font-weight: 600;
  color: var(--theme-text-primary);
  margin-bottom: 12px;
}

.accessibility-docs-content {
  color: var(--theme-text-secondary);
  line-height: 1.6;
}

.accessibility-docs-list {
  list-style: none;
  padding: 0;
  margin: 12px 0;
}

.accessibility-docs-item {
  padding: 8px 0;
  border-bottom: 1px solid var(--theme-border-primary);
}

.accessibility-docs-item:last-child {
  border-bottom: none;
}

.accessibility-docs-item strong {
  color: var(--theme-text-primary);
  font-weight: 600;
}
